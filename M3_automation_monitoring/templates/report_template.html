<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>{{TITLE}}</title>
    <style>
        body { font-family: Segoe UI, Arial, sans-serif; margin: 24px; color: #1a1a1a; }
        h1, h2, h3 { color: #003366; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 16px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .status-green { color: #22863a; }
        .status-yellow { color: #b08800; }
        .status-red { color: #d73a49; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }
        .card { border: 1px solid #ccd6dd; border-radius: 6px; padding: 16px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .chart-container { width: 100%; height: 220px; }
        .badge { padding: 2px 6px; border-radius: 4px; color: #fff; font-weight: bold; }
        .badge-green { background-color: #22863a; }
        .badge-yellow { background-color: #b08800; }
        .badge-red { background-color: #d73a49; }
        footer { font-size: 0.85em; color: #666; margin-top: 24px; }
    </style>
</head>
<body>
    <h1>{{TITLE}}</h1>
    <p>Generated: {{GENERATED_AT}}</p>
    <div class="grid">
        <div class="card">
            <h2>System Health Score</h2>
            <span class="badge {{SCORE_BADGE}}">{{HEALTH_SCORE}}</span>
        </div>
        <div class="card">
            <h2>Alert Summary</h2>
            <p>{{ALERT_SUMMARY}}</p>
        </div>
        <div class="card">
            <h2>Top Recommendations</h2>
            <ul>
            {{RECOMMENDATIONS_LIST}}
            </ul>
        </div>
    </div>

    <h2>Historical Trends</h2>
    <canvas id="trendChart" class="chart-container"></canvas>

    <h2>Resource Usage</h2>
    <table>
        <thead>
            <tr><th>Metric</th><th>Current</th><th>Yesterday</th><th>Last Week</th><th>Status</th></tr>
        </thead>
        <tbody>
        {{METRIC_ROWS}}
        </tbody>
    </table>

    <h2>Services</h2>
    <table>
        <thead>
            <tr><th>Service</th><th>Status</th><th>Start Type</th><th>Notes</th></tr>
        </thead>
        <tbody>
        {{SERVICE_ROWS}}
        </tbody>
    </table>

    <h2>Disk Usage</h2>
    <table>
        <thead>
            <tr><th>Volume</th><th>Total (GB)</th><th>Used (GB)</th><th>Free (GB)</th><th>Usage %</th></tr>
        </thead>
        <tbody>
        {{DISK_ROWS}}
        </tbody>
    </table>

    <h2>Security Events (Last {{SECURITY_DAYS}} Days)</h2>
    <table>
        <thead>
            <tr><th>Category</th><th>Count</th></tr>
        </thead>
        <tbody>
        {{SECURITY_ROWS}}
        </tbody>
    </table>

    <script>
    (function () {
        var ctx = document.getElementById('trendChart');
        if (!ctx || !ctx.getContext) { return; }
        var data = {{TREND_DATA_JSON}};
        var canvas = ctx.getContext('2d');
        var width = ctx.width;
        var height = ctx.height;
        var padding = 32;
        var maxValue = Math.max.apply(null, data.map(function (point) { return point.value; }));
        var minValue = Math.min.apply(null, data.map(function (point) { return point.value; }));
        var range = maxValue - minValue || 1;
        canvas.strokeStyle = '#003366';
        canvas.lineWidth = 2;
        canvas.beginPath();
        data.forEach(function (point, index) {
            var x = padding + (index * (width - (2 * padding)) / Math.max(1, data.length - 1));
            var y = height - padding - ((point.value - minValue) / range) * (height - (2 * padding));
            if (index === 0) {
                canvas.moveTo(x, y);
            } else {
                canvas.lineTo(x, y);
            }
        });
        canvas.stroke();
    }());
    </script>

    <footer>
        Generated by WinSysAuto M3 Automation Monitoring Module.
    </footer>
</body>
</html>
